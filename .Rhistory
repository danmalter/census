getLatLon(cities)
cities <- c(Chicago", "New York")
getDemographics(cities, radius)
getDemographics <- function(cities, radius) {
geo <- geocode(cities)
lat_lon <- data.frame(cbind(cities, geo$lon, geo$lat))
names(lat_lon)[2] <- "lon"
names(lat_lon)[3] <- "lat"
# Remove spaces between city names.  Example "New York" to "NewYork".
cities.lst <- list(lat_lon$cities)
for (i in 1:length(cities.lst)){
cities.lst <- gsub("[[:space:]]", "", cities.lst[[i]])
}
lon.lst <- unlist(as.character(lat_lon$lon))
lat.lst <- unlist(as.character(lat_lon$lat))
#radius <- 2
url=as.list(paste("http://mcdc.missouri.edu/cgi-bin/broker",
"?_PROGRAM=websas.caps10acsb.sas&SERVICE=appdev",
"&sitename=", cities.lst,
"&longitude=", lon.lst,
"&latitude=", lat.lst,
"&radii=", radius,
"&dprofile=on&eprofile=on&sprofile=on&hprofile=on",
"&cntypops=on&printdetail=on&_debug=",
sep=""))
print(url)
result = list()
for (i in 1:length(url)){
html <- getURL(url[[i]])
pattern <- "href=\"/tmpscratch/caps10acs(.*?).csv\""
match.info <- regexec(pattern=pattern, text=html)
num.start <- match.info[[1]][2]
num.length <- attr(match.info[[1]], "match.length")[2]
num <- substr(html, num.start, num.start + num.length - 1)
file.location <- paste("http://mcdc.missouri.edu/tmpscratch/",
"caps10acs", num, ".csv",
sep="")
file.location
data.tmp <- data.frame(read.csv(file=file.location, colClasses = "character"))
result[[i]] <- data.tmp
}
final.result <- do.call(rbind, result)
#head(final.result)
return(final.result[1:2, 1:10])
}
cities <- c("Chicago", "New York")
getDemographics(cities, radius)
library(censusR)
library(censusR)
radius <- 2
cities <- c("Chicago", "New York")
getDemographics(cities, radius)
library(censusR)
getDemographics(cities, radius)
library(ggmap)
getDemographics(cities, radius)
R.Version()
library(censusR)
getDemographics(cities, radius)
import(ggmap)
library(censusR)
getDemographics(cities, radius)
library(censusR)
getDemographics(cities, radius)
library(censusR)
getDemographics(cities, radius)
